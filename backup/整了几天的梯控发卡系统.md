### åˆè¡· 
è™½è¯´è¿™æ ·ç³»ç»Ÿæ²¡ä»€ä¹ˆç ”ç©¶ä»·å€¼äº†ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œé‡åˆ°ä¸€ä¸ªå·®ç‚¹å°±è§£ä¸å¼€å¡äº†ã€‚å¥½åœ¨æœ‰æƒŠæ— é™©çš„è§£å¼€äº† 
ç³»ç»Ÿä¸ºäº’è”åˆ›ï¼Œæ²¡å¼€å¯æ»šåŠ¨ä½ ï¼Œä¸€å¡ä¸€å¯†çš„ç³»ç»Ÿ ï¼Œä¹Ÿå¯ä»¥åˆå§‹æ»šåŠ¨ä½ã€‚
é—®åˆ«é—®è¦äº†ä¸ªå¯†é’¥è®¡ç®—è½¯ä»¶ï¼Œå¥½åœ¨è¿˜æœ‰ä¸ªç®—æ³•è¡¨ ï¼ŒåŸºäºè¿™ä¸ªç®—æ³•è¡¨ ä½¿ç”¨python æ•´å‡ºäº†è½¯ä»¶ï¼Œ
### å¥‡æ€ªçš„BUG 
è™½ç„¶æå‡ºæ¥äº†ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†è¿˜æ˜¯ç®—çš„å¯¹ ï¼Œåªæ˜¯æœ‰çš„ç‰¹æ®Šå­—èŠ‚å¯†é’¥ä¼šç®—é”™ï¼Œæä¸æ‡‚ å‹‰å¼ºè¿™æ ·ç”¨å§ï¼
è¿˜è·Ÿæ®ç®—æ³•æ·»åŠ äº†åæ¨å›­åŒºç åŠŸèƒ½ã€‚å’±ä¹Ÿæ²¡éªŒè¯è¿™ä¸ªåŠŸèƒ½å‡†ç¡®ä¸å‡†ç¡®ï¼Œä½†æ˜¯åŸºäºæ ·æœ¬åæ¨å‡ºæ¥çš„åŸºæœ¬æ˜¯å‡†ç¡®çš„ï¼Œæœ‰å¾…éªŒè¯ã€‚
### è´´å‡ºä»£ç ä½œä¸ºå¤‡ä»½ï¼
åç»­å¦‚æœç®—æ³•å®Œå–„äº†ï¼Œåç»­åŸºäºæœ¬ä»£ç ç»§ç»­æ·»åŠ ä¼˜åŒ–ï¼
###  å·²ä¿®å¤ BUG
~~~
import tkinter as tk
from tkinter import messagebox, ttk
import pyperclip

class InterlinkDeepFixTool:
    def __init__(self, root):
        self.root = root
        self.root.title("äº’è”åˆ›")
        
        # çª—å£å°ºå¯¸ 600x750
        self.root.geometry("600x750") 
        self.root.configure(bg="#ECEFF1")
        
        # æ ¸å¿ƒæ˜ å°„é€»è¾‘
        self.MAP_P1 = {'0':'B','1':'C','2':'D','3':'E','4':'B','5':'C','6':'D','7':'E','8':'3','9':'4','A':'5','B':'6','C':'3','D':'4','E':'5','F':'6'}
        self.MAP_P3_BASE = {
            '0':('A','B'), '1':('A','B'), '2':('C','D'), '3':('C','D'),
            '4':('A','B'), '5':('A','B'), '6':('C','D'), '7':('C','D'),
            '8':('2','3'), '9':('2','3'), 'A':('4','5'), 'B':('4','5'),
            'C':('2','3'), 'D':('2','3'), 'E':('4','5'), 'F':('4','5')
        }
        self.MAP_P4 = {'0':'E','1':'E','2':'0','3':'0','4':'2','5':'2','6':'4','7':'4','8':'6','9':'6','A':'8','B':'8','C':'A','D':'A','E':'C','F':'C'}

        self.setup_styles()
        self.setup_ui()

    def setup_styles(self):
        self.style = ttk.Style()
        self.style.theme_use('clam')
        self.style.configure("TNotebook", background="#ECEFF1", borderwidth=0)
        self.style.configure("TNotebook.Tab", font=('å¾®è½¯é›…é»‘', 10), padding=[12, 5], background="#CFD8DC")
        self.style.map("TNotebook.Tab", background=[("selected", "#263238")], foreground=[("selected", "white")])

    def setup_ui(self):
        # é¡¶éƒ¨æ ‡é¢˜æ 
        header = tk.Frame(self.root, bg="#263238", height=50)
        header.pack(fill='x')
        tk.Label(header, text="äº’è”åˆ›å¯†é’¥åæ¨å·¥å…·", fg="#80D8FF", bg="#263238", font=('å¾®è½¯é›…é»‘', 12, 'bold')).pack(pady=12)

        # ä¸»å®¹å™¨
        self.notebook = ttk.Notebook(self.root)
        self.notebook.pack(expand=True, fill='both', padx=15, pady=10)

        # --- é¡µé¢ 1ï¼šæ­£å‘è®¡ç®— ---
        fwd_page = tk.Frame(self.notebook, bg="white", padx=25, pady=20)
        self.notebook.add(fwd_page, text=" ğŸ”’ æ­£å‘è®¡ç®— ")

        # ç§»é™¤äº†æç¤ºæ–‡å­—
        self.f_card = self.create_clean_input(fwd_page, "å¡å· ")
        self.f_park = self.create_clean_input(fwd_page, "å›­åŒºç ")

        tk.Button(fwd_page, text="å¼€å§‹è®¡ç®—å¯†é’¥", command=self.run_fwd, 
                  bg="#0288D1", fg="white", font=('å¾®è½¯é›…é»‘', 11, 'bold'), 
                  relief='flat', cursor='hand2', activebackground="#01579B", pady=8).pack(fill='x', pady=20)

        res_container = tk.LabelFrame(fwd_page, text=" è¾“å‡ºç»“æœ ", bg="white", font=('å¾®è½¯é›…é»‘', 9))
        res_container.pack(fill='x', pady=10)
        self.f_res = tk.Entry(res_container, font=('Consolas', 22, 'bold'), fg="#D32F2F", justify='center', bg="#F5F5F5", bd=0)
        self.f_res.pack(fill='x', padx=15, pady=15)
        
        tk.Button(fwd_page, text="å¤åˆ¶ç»“æœ", command=lambda: self.copy_to_clip(self.f_res.get()), 
                  fg="#546E7A", bg="white", bd=0, font=('å¾®è½¯é›…é»‘', 9, 'underline'), cursor='hand2').pack()

        # --- é¡µé¢ 2ï¼šé€†å‘åæ¨ ---
        rev_page = tk.Frame(self.notebook, bg="white", padx=15, pady=10)
        self.notebook.add(rev_page, text=" ğŸ”“ å›­åŒºç åæ¨ ")

        sample_frame = tk.LabelFrame(rev_page, text=" æ ·æœ¬é‡‡é›† (å¡å· -> å¯¹åº”å¯†é’¥) ", bg="white", font=('å¾®è½¯é›…é»‘', 9), padx=10, pady=10)
        sample_frame.pack(fill='x')

        self.rev_samples = []
        for i in range(3):
            row = tk.Frame(sample_frame, bg="white")
            row.pack(fill='x', pady=5)
            tk.Label(row, text=f"#{i+1}", bg="white", font=('Consolas', 10, 'bold'), width=3).pack(side='left')
            
            c_ent = tk.Entry(row, width=12, font=('Consolas', 11), bg="#F1F3F4", bd=0)
            c_ent.pack(side='left', padx=5, ipady=5)
            tk.Label(row, text="â†’", bg="white", font=('Arial', 10)).pack(side='left')
            k_ent = tk.Entry(row, font=('Consolas', 11), bg="#F1F3F4", bd=0)
            k_ent.pack(side='left', padx=5, ipady=5, fill='x', expand=True)
            self.rev_samples.append((c_ent, k_ent))

        tk.Button(rev_page, text="åæ¨å›­åŒºç ", command=self.run_rev, 
                  bg="#F57C00", fg="white", font=('å¾®è½¯é›…é»‘', 10, 'bold'), relief='flat', pady=5).pack(fill='x', pady=15)

        log_label = tk.Label(rev_page, text="åˆ†ææ—¥å¿—ä¸å€™é€‰å€¼:", bg="white", font=('å¾®è½¯é›…é»‘', 8), fg="#78909C")
        log_label.pack(anchor='w')
        self.rev_log = tk.Text(rev_page, height=12, font=('Consolas', 9), bg="#102027", fg="#64FFDA", padx=10, pady=10, bd=0)
        self.rev_log.pack(fill='both', expand=True)

    def create_clean_input(self, parent, label):
        """åˆ›å»ºä¸€ä¸ªæ²¡æœ‰æç¤ºæ–‡å­—çš„è¾“å…¥ç»„"""
        frame = tk.Frame(parent, bg="white")
        frame.pack(fill='x', pady=8)
        tk.Label(frame, text=label, bg="white", font=('å¾®è½¯é›…é»‘', 10, 'bold'), fg="#37474F").pack(anchor='w')
        ent = tk.Entry(frame, font=('Consolas', 12), bg="#F1F3F4", bd=0)
        ent.pack(fill='x', ipady=8, pady=5)
        tk.Frame(frame, height=2, bg="#CFD8DC").pack(fill='x')
        return ent

    def copy_to_clip(self, text):
        if text.strip():
            pyperclip.copy(text)
            messagebox.showinfo("æç¤º", "å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")

    def run_fwd(self):
        try:
            c, p = self.f_card.get().strip().upper(), self.f_park.get().strip().upper()
            if len(c) != 8 or len(p) != 8: raise ValueError("è¯·è¾“å…¥8ä½16è¿›åˆ¶æ•°æ®")
            cb = [int(c[i:i+2], 16) for i in range(0, 8, 2)]
            pb = [int(p[i:i+2], 16) for i in range(0, 8, 2)]
            p3_idx = 1 if c[3] not in ['0', '1'] else 0
            pre = f"{self.MAP_P1[c[0]]}0{self.MAP_P3_BASE[c[2]][p3_idx]}{self.MAP_P4[c[3]]}"
            b3, b4 = (cb[0]|pb[0])+(cb[2]&pb[0]), (cb[1]|pb[1])+(cb[3]&pb[1])
            res = f"{pre}{b3&0xFF:02X}{b4&0xFF:02X}{(cb[2]|pb[2])&0xFF:02X}{(cb[3]|pb[3])&0xFF:02X}"
            self.f_res.delete(0, tk.END); self.f_res.insert(0, res)
        except Exception as e: messagebox.showerror("é”™è¯¯", str(e))

    def run_rev(self):
        self.rev_log.delete('1.0', tk.END)
        try:
            samples = []
            for c_ent, k_ent in self.rev_samples:
                c, k = c_ent.get().strip().upper(), k_ent.get().strip().upper()
                if len(c) == 8 and len(k) == 12:
                    samples.append({'cb': [int(c[i:i+2], 16) for i in range(0, 8, 2)], 
                                   'kb': [int(k[i:i+2], 16) for i in range(0, 12, 2)]})
            
            if not samples:
                self.rev_log.insert(tk.END, "> è¯·è‡³å°‘è¾“å…¥ä¸€ç»„å®Œæ•´æ ·æœ¬ä»¥ä¾›åˆ†æ...")
                return

            self.rev_log.insert(tk.END, f"> æ­£åœ¨åˆ†æ {len(samples)} ç»„æ ·æœ¬...\n")
            park_bytes_cands = []
            for i in range(4):
                intersect_set = set()
                for idx, s in enumerate(samples):
                    cb, kb, cands = s['cb'], s['kb'], set()
                    for p in range(256):
                        if i == 0: val = ((cb[0]|p) + (cb[2]&p)) & 0xFF
                        elif i == 1: val = ((cb[1]|p) + (cb[3]&p)) & 0xFF
                        elif i == 2: val = (cb[2]|p) & 0xFF
                        else: val = (cb[3]|p) & 0xFF
                        if val == kb[i+2]: cands.add(f"{p:02X}")
                    if idx == 0: intersect_set = cands
                    else: intersect_set &= cands
                park_bytes_cands.append(sorted(list(intersect_set)))

            res_code = "".join([ (cl[0] if len(cl)==1 else (([n for n in cl if n.isdigit()]+cl)[0] if cl else "??")) for cl in park_bytes_cands])
            self.rev_log.insert(tk.END, f"\n[ è¯†åˆ«å‡ºçš„å›­åŒºç  ]: {res_code}\n")
            self.rev_log.insert(tk.END, "="*30 + "\nå­—èŠ‚å€™é€‰å€¼:\n")
            for i, l in enumerate(park_bytes_cands): 
                self.rev_log.insert(tk.END, f" P{i+1}: {', '.join(l) if l else 'æ— åŒ¹é…'}\n")
        except Exception as e: self.rev_log.insert(tk.END, f"\n[ å¼‚å¸¸ ]: {str(e)}")

if __name__ == "__main__":
    root = tk.Tk()
    app = InterlinkDeepFixTool(root)
    root.mainloop()


~~~
